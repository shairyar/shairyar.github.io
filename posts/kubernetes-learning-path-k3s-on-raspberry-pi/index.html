<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Kubernetes Learning Path: Setting Up k3s on Raspberry Pi" /><meta property="og:locale" content="en" /><meta name="description" content="Kubernetes Learning Path: Setting Up k3s on Raspberry Pi" /><meta property="og:description" content="Kubernetes Learning Path: Setting Up k3s on Raspberry Pi" /><link rel="canonical" href="https://shairyar.github.io/posts/kubernetes-learning-path-k3s-on-raspberry-pi/" /><meta property="og:url" content="https://shairyar.github.io/posts/kubernetes-learning-path-k3s-on-raspberry-pi/" /><meta property="og:site_name" content="Shairyar Baig" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-10-29T10:00:00+05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Kubernetes Learning Path: Setting Up k3s on Raspberry Pi" /><meta name="twitter:site" content="@iamshairyar" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-10-29T10:00:00+05:00","datePublished":"2025-10-29T10:00:00+05:00","description":"Kubernetes Learning Path: Setting Up k3s on Raspberry Pi","headline":"Kubernetes Learning Path: Setting Up k3s on Raspberry Pi","mainEntityOfPage":{"@type":"WebPage","@id":"https://shairyar.github.io/posts/kubernetes-learning-path-k3s-on-raspberry-pi/"},"url":"https://shairyar.github.io/posts/kubernetes-learning-path-k3s-on-raspberry-pi/"}</script><title>Kubernetes Learning Path: Setting Up k3s on Raspberry Pi | Shairyar Baig</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Shairyar Baig"><meta name="application-name" content="Shairyar Baig"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-3MSE8F2TRT"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-3MSE8F2TRT'); }); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="https://pbs.twimg.com/profile_images/1531277756490825728/myc7uFj__400x400.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Shairyar Baig</a><p class="site-subtitle fst-italic mb-0">tinkering with stuff</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/shairyar" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/iamshairyar" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['shairyarbaig','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Kubernetes Learning Path: Setting Up k3s on Raspberry Pi</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Kubernetes Learning Path: Setting Up k3s on Raspberry Pi</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1761714000" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 29, 2025 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/iamshairyar">Shairyar Baig</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2801 words" > <em>15 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Kubernetes Learning Path: Setting Up k3s on Raspberry Pi</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Kubernetes Learning Path: Setting Up k3s on Raspberry Pi</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h1 id="kubernetes-learning-path-setting-up-k3s-on-raspberry-pi">Kubernetes Learning Path: Setting Up k3s on Raspberry Pi</h1><p>After going through the first four parts of this series with k3d, I felt ready to take things to the next level. k3d is great for learning and local development, but there’s something different about running Kubernetes on actual hardware. You deal with real networking, real resource constraints, and real high availability scenarios that you just can’t simulate properly on a single machine.</p><p>So I decided to set up a 3-node Kubernetes cluster on Raspberry Pi devices using k3s. This would give me a production-like environment at home where I could practice everything I learned with k3d, but on real distributed hardware.</p><p>I’ll be honest—this took me a couple of hours and involved some head-scratching moments. But once everything clicked into place and I saw all three nodes showing “Ready” status, it felt amazing. Let me walk you through what I did, what went wrong, and what I learned.</p><h2 id="why-raspberry-pi-and-k3s"><span class="me-2">Why Raspberry Pi and k3s?</span><a href="#why-raspberry-pi-and-k3s" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Before we dive in, you might be wondering why I chose this setup.</p><p>I went with <strong>Raspberry Pi</strong> because they’re affordable, don’t cost much to run 24/7, and honestly it’s just fun to build things with them. Plus, dealing with ARM architecture and limited resources teaches you a lot about how Kubernetes manages resources—you can’t just throw CPU and RAM at problems like you might on a beefy server.</p><p>As for <strong>k3s</strong>, it’s basically Kubernetes but lightweight enough to actually run on a Pi without choking it. The best part? It has the same API as full Kubernetes, so everything you learn transfers directly. I wasn’t interested in running some toy version of Kubernetes—I wanted the real thing, just smaller.</p><h2 id="what-youll-need"><span class="me-2">What You’ll Need</span><a href="#what-youll-need" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Here’s what I used for my setup:</p><p><strong>Hardware:</strong></p><ul><li>3× Raspberry Pi 4 (I’d recommend 4GB+ RAM each)<li>3× SSD drives (You can try using an SD card, but I did not want to use it)<li>Ethernet cables for all Pis<li>A network switch or router with enough ports<li>Power supplies for each Pi</ul><p><strong>Software:</strong></p><ul><li>Ubuntu Server 24.04 LTS on all devices<li>SSH access to all Pis</ul><p>I went with Ubuntu Server because I’m already familiar with it. You could probably use Raspberry Pi OS too, but I stuck with what I know.</p><h2 id="the-big-picture"><span class="me-2">The Big Picture</span><a href="#the-big-picture" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Before we start, here’s what we’re building:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>My Network (192.168.18.0/24)
│
├── k3s-master (192.168.18.49)      [Control Plane]
├── k3s-worker-1 (192.168.18.51)    [Worker Node]
└── k3s-worker-2 (192.168.18.52)    [Worker Node]
</pre></table></code></div></div><p>The master node runs the Kubernetes control plane (API server, scheduler, etc.), and the worker nodes run your actual application workloads. All three nodes are connected via ethernet for stability.</p><h2 id="step-1-network-setupthe-foundation-that-matters"><span class="me-2">Step 1: Network Setup—The Foundation That Matters</span><a href="#step-1-network-setupthe-foundation-that-matters" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This was the most important step, and I learned it the hard way. If your master node’s IP address changes after you’ve set up the cluster, the whole thing breaks. Worker nodes connect to the master using its IP, and that IP is hardcoded during the join process.</p><p>So the very first thing you need to do is set up static IP addresses on all your Raspberry Pis.</p><h3 id="configure-static-ips-with-netplan"><span class="me-2">Configure Static IPs with Netplan</span><a href="#configure-static-ips-with-netplan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>On each Raspberry Pi, I configured a static IP using netplan. Here’s what I did on the master node:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/netplan/50-cloud-init.yaml
</pre></table></code></div></div><p>I replaced the contents with this configuration:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="na">network</span><span class="pi">:</span>
  <span class="na">version</span><span class="pi">:</span> <span class="m">2</span>
  <span class="na">renderer</span><span class="pi">:</span> <span class="s">networkd</span>
  <span class="na">ethernets</span><span class="pi">:</span>
    <span class="na">eth0</span><span class="pi">:</span>
      <span class="na">dhcp4</span><span class="pi">:</span> <span class="s">no</span>
      <span class="na">addresses</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">192.168.18.49/24</span>  <span class="c1"># Master node IP</span>
      <span class="na">routes</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">to</span><span class="pi">:</span> <span class="s">0.0.0.0/0</span>
          <span class="na">via</span><span class="pi">:</span> <span class="s">192.168.18.1</span>  <span class="c1"># Your router IP</span>
          <span class="na">metric</span><span class="pi">:</span> <span class="m">100</span>
      <span class="na">nameservers</span><span class="pi">:</span>
        <span class="na">addresses</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">8.8.8.8</span>
          <span class="pi">-</span> <span class="s">1.1.1.1</span>
</pre></table></code></div></div><p><strong>Important things to note:</strong></p><ul><li>Replace <code class="language-plaintext highlighter-rouge">192.168.18.49</code> with your desired static IP<li>Replace <code class="language-plaintext highlighter-rouge">192.168.18.1</code> with your router’s IP (usually 192.168.1.1 or 192.168.0.1)<li>Use different IPs for each node (.49 for master, .51 for worker-1, .52 for worker-2)</ul><p>Apply the configuration:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>netplan apply
</pre></table></code></div></div><p>Verify the IP address:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ip addr show eth0
</pre></table></code></div></div><p>You should see your static IP address listed. If you don’t have network access after applying, double-check that your router IP and subnet are correct.</p><blockquote class="prompt-tip"><p><strong>Pro tip:</strong> I initially had both WiFi and ethernet active on my Pis, which caused routing conflicts. I disabled WiFi completely and used only ethernet. Much more stable.</p></blockquote><h3 id="set-up-hostname-resolution"><span class="me-2">Set Up Hostname Resolution</span><a href="#set-up-hostname-resolution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To make life easier, I set up <code class="language-plaintext highlighter-rouge">/etc/hosts</code> on all nodes so I could use hostnames instead of IP addresses:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/hosts
</pre></table></code></div></div><p>Add these lines on <strong>all three nodes</strong>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>192.168.18.49   k3s-master
192.168.18.51   k3s-worker-1
192.168.18.52   k3s-worker-2
</pre></table></code></div></div><p>Now you can ping by hostname:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ping k3s-master
</pre></table></code></div></div><p>This makes troubleshooting and managing the cluster much easier.</p><h2 id="step-2-preparing-all-nodes"><span class="me-2">Step 2: Preparing All Nodes</span><a href="#step-2-preparing-all-nodes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Before installing k3s, each Raspberry Pi needs some preparation. I had to do these steps on <strong>all three nodes</strong>.</p><h3 id="system-updates"><span class="me-2">System Updates</span><a href="#system-updates" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Always start with updates:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt upgrade <span class="nt">-y</span>
<span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> curl vim git
</pre></table></code></div></div><p>This took about 10-15 minutes per Pi on my internet connection.</p><h3 id="set-hostnames"><span class="me-2">Set Hostnames</span><a href="#set-hostnames" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>On each Pi, set the appropriate hostname:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c"># On master node:</span>
<span class="nb">sudo </span>hostnamectl set-hostname k3s-master

<span class="c"># On worker-1:</span>
<span class="nb">sudo </span>hostnamectl set-hostname k3s-worker-1

<span class="c"># On worker-2:</span>
<span class="nb">sudo </span>hostnamectl set-hostname k3s-worker-2
</pre></table></code></div></div><p>Verify:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">hostname</span>
</pre></table></code></div></div><h3 id="enable-legacy-iptables"><span class="me-2">Enable Legacy iptables</span><a href="#enable-legacy-iptables" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This step confused me at first. Modern Ubuntu uses something called nftables by default, but k3s needs the older iptables-legacy for its networking to work. I didn’t really understand why until I forgot to do it on one node and spent an hour debugging why pods couldn’t talk to each other.</p><p>Run this on <strong>all nodes</strong>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>update-alternatives <span class="nt">--set</span> iptables /usr/sbin/iptables-legacy
<span class="nb">sudo </span>update-alternatives <span class="nt">--set</span> ip6tables /usr/sbin/ip6tables-legacy
</pre></table></code></div></div><p>Lesson learned: don’t skip this step.</p><h3 id="enable-cgroup-memory"><span class="me-2">Enable cgroup Memory</span><a href="#enable-cgroup-memory" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Kubernetes needs cgroup support for resource management (CPU and memory limits). This requires editing the boot parameters:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nano /boot/firmware/cmdline.txt
</pre></table></code></div></div><p>You’ll see a long line of parameters. Add these to the <strong>end of the existing line</strong> (don’t create a new line):</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cgroup_enable=cpuset cgroup_memory=1 cgroup_enable=memory
</pre></table></code></div></div><p>The entire line might look something like this:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>console=serial0,115200 console=tty1 root=PARTUUID=12345678-02 rootfstype=ext4 elevator=deadline rootwait cgroup_enable=cpuset cgroup_memory=1 cgroup_enable=memory
</pre></table></code></div></div><blockquote class="prompt-warning"><p><strong>Warning:</strong> These parameters must be on the same line as the existing boot parameters. If you put them on a new line, they won’t work.</p></blockquote><p>Save the file and reboot:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>reboot
</pre></table></code></div></div><p>After the reboot, verify cgroup memory is enabled:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">cat</span> /proc/cgroups | <span class="nb">grep </span>memory
</pre></table></code></div></div><p>You should see output showing memory cgroup support.</p><h2 id="step-3-installing-k3s-on-the-master-node"><span class="me-2">Step 3: Installing k3s on the Master Node</span><a href="#step-3-installing-k3s-on-the-master-node" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Okay, now for the fun part—actually installing k3s. After all that prep work, the installation itself is almost anticlimactic. On the master node:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="nt">-sfL</span> https://get.k3s.io | sh -
</pre></table></code></div></div><p>That’s it. The script downloads and installs k3s automatically. It took about 2-3 minutes on my Pi.</p><h3 id="verify-the-master-node"><span class="me-2">Verify the Master Node</span><a href="#verify-the-master-node" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Check that k3s is running:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl status k3s
</pre></table></code></div></div><p>You should see output showing k3s is “active (running)”.</p><p>Check the node status:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>k3s kubectl get nodes
</pre></table></code></div></div><p>Output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>NAME         STATUS   ROLES                  AGE   VERSION
k3s-master   Ready    control-plane,master   30s   v1.27.7+k3s1
</pre></table></code></div></div><p>Seeing “Ready” status means the master node is operational.</p><h3 id="get-the-join-token"><span class="me-2">Get the Join Token</span><a href="#get-the-join-token" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Worker nodes need a token to join the cluster. Get it from the master:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo cat</span> /var/lib/rancher/k3s/server/node-token
</pre></table></code></div></div><p>You’ll see a long token like:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>K107f8a9b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0z::server:a1b2c3d4e5f6g7h8i9j0
</pre></table></code></div></div><p>Copy this token—you’ll need it in the next step. I saved it to a text file for easy reference.</p><h3 id="set-up-kubectl-access"><span class="me-2">Set Up kubectl Access</span><a href="#set-up-kubectl-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>By default, you need <code class="language-plaintext highlighter-rouge">sudo</code> to run kubectl commands. Let’s fix that:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nb">mkdir</span> ~/.kube
<span class="nb">sudo cp</span> /etc/rancher/k3s/k3s.yaml ~/.kube/config
<span class="nb">sudo chown</span> <span class="nv">$USER</span>:<span class="nv">$USER</span> ~/.kube/config
<span class="nb">chmod </span>600 ~/.kube/config
</pre></table></code></div></div><p>Now you can run kubectl without sudo:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl get nodes
</pre></table></code></div></div><p>Much better.</p><h3 id="access-the-cluster-from-your-laptop"><span class="me-2">Access the Cluster from Your Laptop</span><a href="#access-the-cluster-from-your-laptop" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Honestly, SSHing into the master node every time you want to run a kubectl command gets old fast. Let’s set it up so you can manage the cluster directly from your laptop.</p><p>First, make sure you have kubectl installed on your local machine. If you don’t:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c"># macOS</span>
brew <span class="nb">install </span>kubectl

<span class="c"># Linux</span>
curl <span class="nt">-LO</span> <span class="s2">"https://dl.k8s.io/release/</span><span class="si">$(</span>curl <span class="nt">-L</span> <span class="nt">-s</span> https://dl.k8s.io/release/stable.txt<span class="si">)</span><span class="s2">/bin/linux/amd64/kubectl"</span>
<span class="nb">sudo install</span> <span class="nt">-o</span> root <span class="nt">-g</span> root <span class="nt">-m</span> 0755 kubectl /usr/local/bin/kubectl
</pre></table></code></div></div><p>Now, copy the kubeconfig from the master node to your laptop. On your <strong>local machine</strong>, run:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># Create .kube directory if it doesn't exist</span>
<span class="nb">mkdir</span> <span class="nt">-p</span> ~/.kube

<span class="c"># Copy the config from master node</span>
scp user@192.168.18.49:~/.kube/config ~/.kube/k3s-config
</pre></table></code></div></div><p>Replace <code class="language-plaintext highlighter-rouge">user</code> with your actual username on the Pi, and adjust the IP if needed.</p><p>Here’s the important part: the config file references <code class="language-plaintext highlighter-rouge">127.0.0.1</code> (localhost), which works when you’re on the master node but not from your laptop. You need to change it to the master node’s actual IP.</p><p>Edit the file:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nano ~/.kube/k3s-config
</pre></table></code></div></div><p>Find this line:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="na">server</span><span class="pi">:</span> <span class="s">https://127.0.0.1:6443</span>
</pre></table></code></div></div><p>Change it to:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="na">server</span><span class="pi">:</span> <span class="s">https://192.168.18.49:6443</span>
</pre></table></code></div></div><p>Save and exit. Now tell kubectl to use this config:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">KUBECONFIG</span><span class="o">=</span>~/.kube/k3s-config
</pre></table></code></div></div><p>Test it:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl get nodes
</pre></table></code></div></div><p>Output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>NAME         STATUS   ROLES                  AGE   VERSION
k3s-master   Ready    control-plane,master   10m   v1.27.7+k3s1
</pre></table></code></div></div><p>It works! You’re now managing the cluster from your laptop without SSH.</p><blockquote class="prompt-tip"><p><strong>Pro tip:</strong> If you want this to persist across terminal sessions, add <code class="language-plaintext highlighter-rouge">export KUBECONFIG=~/.kube/k3s-config</code> to your <code class="language-plaintext highlighter-rouge">~/.bashrc</code> or <code class="language-plaintext highlighter-rouge">~/.zshrc</code> file. Or, if you want to merge it with your default kubeconfig, you can copy the content into <code class="language-plaintext highlighter-rouge">~/.kube/config</code> and use context switching.</p></blockquote><p>This makes the whole experience way more convenient. I can be coding on my laptop, deploy to the cluster with <code class="language-plaintext highlighter-rouge">kubectl apply</code>, and check logs—all without leaving my editor or opening another terminal to SSH.</p><h2 id="step-4-joining-worker-nodes"><span class="me-2">Step 4: Joining Worker Nodes</span><a href="#step-4-joining-worker-nodes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now let’s add the worker nodes to the cluster. On <strong>each worker node</strong>, run this command (replace the token with your actual token from the master):</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>curl <span class="nt">-sfL</span> https://get.k3s.io | <span class="nv">K3S_URL</span><span class="o">=</span>https://192.168.18.49:6443 <span class="se">\</span>
  <span class="nv">K3S_TOKEN</span><span class="o">=</span>K107f8a9b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0z::server:a1b2c3d4e5f6g7h8i9j0 sh -
</pre></table></code></div></div><p><strong>What this does:</strong></p><ul><li><code class="language-plaintext highlighter-rouge">K3S_URL</code> tells the worker where the master node is<li><code class="language-plaintext highlighter-rouge">K3S_TOKEN</code> authenticates the worker with the master<li>The script installs k3s in agent mode (worker mode)</ul><p>Installation takes a couple of minutes per worker.</p><h3 id="verify-worker-nodes"><span class="me-2">Verify Worker Nodes</span><a href="#verify-worker-nodes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>On each worker, check that the k3s agent is running:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl status k3s-agent
</pre></table></code></div></div><p>You should see “active (running)”.</p><p>Now go back to the <strong>master node</strong> and check all nodes:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl get nodes
</pre></table></code></div></div><p>Output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>NAME           STATUS   ROLES                  AGE     VERSION
k3s-master     Ready    control-plane,master   5m      v1.27.7+k3s1
k3s-worker-1   Ready    &lt;none&gt;                 2m      v1.27.7+k3s1
k3s-worker-2   Ready    &lt;none&gt;                 1m      v1.27.7+k3s1
</pre></table></code></div></div><p>All three nodes showing “Ready”! This is the moment where all the preparation pays off. You now have a working Kubernetes cluster running on real hardware.</p><h2 id="step-5-testing-the-cluster"><span class="me-2">Step 5: Testing the Cluster</span><a href="#step-5-testing-the-cluster" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s deploy something to make sure everything actually works. I’ll deploy a simple nginx application with 3 replicas, which should spread across all the worker nodes.</p><p>Create a file called <code class="language-plaintext highlighter-rouge">nginx-test.yaml</code>:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">nginx-test</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">3</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">matchLabels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">nginx</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">metadata</span><span class="pi">:</span>
      <span class="na">labels</span><span class="pi">:</span>
        <span class="na">app</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">nginx</span>
        <span class="na">image</span><span class="pi">:</span> <span class="s">nginx:alpine</span>
        <span class="na">ports</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">80</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Service</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">nginx-service</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">NodePort</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">nginx</span>
  <span class="na">ports</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">port</span><span class="pi">:</span> <span class="m">80</span>
    <span class="na">targetPort</span><span class="pi">:</span> <span class="m">80</span>
    <span class="na">nodePort</span><span class="pi">:</span> <span class="m">30080</span>
</pre></table></code></div></div><p>Deploy it:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl apply <span class="nt">-f</span> nginx-test.yaml
</pre></table></code></div></div><p>Output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>deployment.apps/nginx-test created
service/nginx-service created
</pre></table></code></div></div><p>Watch the pods come up:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl get pods <span class="nt">-o</span> wide <span class="nt">-w</span>
</pre></table></code></div></div><p>Output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>NAME                          READY   STATUS    RESTARTS   AGE   NODE
nginx-test-7d4c9d8c9b-4xk2p   1/1     Running   0          10s   k3s-worker-1
nginx-test-7d4c9d8c9b-7m8qz   1/1     Running   0          10s   k3s-worker-2
nginx-test-7d4c9d8c9b-9n2kx   1/1     Running   0          10s   k3s-worker-1
</pre></table></code></div></div><p>Notice how the pods are distributed across the worker nodes automatically! Kubernetes is doing its job of spreading the workload.</p><h3 id="access-the-application"><span class="me-2">Access the Application</span><a href="#access-the-application" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Since we used NodePort, we can access the application through any node’s IP on port 30080:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl http://192.168.18.49:30080
</pre></table></code></div></div><p>Or from your laptop’s browser (if you’re on the same network):</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://192.168.18.49:30080
</pre></table></code></div></div><p>You should see the nginx welcome page. Try accessing it through the other nodes too:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>curl http://192.168.18.51:30080
curl http://192.168.18.52:30080
</pre></table></code></div></div><p>All three IPs work! NodePort makes the service available on all nodes, regardless of where the pods are actually running.</p><h2 id="challenges-i-ran-into"><span class="me-2">Challenges I Ran Into</span><a href="#challenges-i-ran-into" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let me share the issues I encountered so you can avoid them:</p><h3 id="wifi-and-ethernet-conflicts"><span class="me-2">WiFi and Ethernet Conflicts</span><a href="#wifi-and-ethernet-conflicts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Initially, I had both WiFi and ethernet enabled on my Pis. This caused weird routing issues where the cluster would work sometimes and fail other times. The solution was to disable WiFi completely in netplan:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="na">network</span><span class="pi">:</span>
  <span class="na">version</span><span class="pi">:</span> <span class="m">2</span>
  <span class="na">renderer</span><span class="pi">:</span> <span class="s">networkd</span>
  <span class="c1"># Wifi disabled - Only eth0</span>
</pre></table></code></div></div><h3 id="cgroup-parameters-on-wrong-line"><span class="me-2">cgroup Parameters on Wrong Line</span><a href="#cgroup-parameters-on-wrong-line" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>My first attempt at adding cgroup parameters, I put them on a new line in <code class="language-plaintext highlighter-rouge">cmdline.txt</code>. This doesn’t work—boot parameters must be on a single line. The fix was to add them to the end of the existing line.</p><h3 id="forgetting-iptables-on-one-node"><span class="me-2">Forgetting iptables on One Node</span><a href="#forgetting-iptables-on-one-node" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>I accidentally skipped the iptables-legacy configuration on one worker node. Pods on that node couldn’t communicate with pods on other nodes. The symptom was that some HTTP requests would work and others would timeout, depending on which pod handled the request. Once I set up iptables-legacy on all nodes and rebooted, everything worked.</p><h2 id="what-i-practiced"><span class="me-2">What I Practiced</span><a href="#what-i-practiced" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now that I have a real cluster, I’ve been practicing all the concepts from the previous posts:</p><p><strong>From the k3d tutorials:</strong></p><ul><li>✅ Multi-replica deployments that actually run on different physical machines<li>✅ ConfigMaps and Secrets for configuration management<li>✅ Namespaces for environment separation<li>✅ Services with NodePort for external access</ul><p><strong>New things with real hardware:</strong></p><ul><li>✅ <strong>Real high availability:</strong> I powered off one worker node and watched Kubernetes automatically reschedule the pods to the remaining nodes. This is the kind of behavior you can’t properly test on k3d.<li>✅ <strong>Resource distribution:</strong> Seeing how Kubernetes spreads pods across nodes based on available resources</ul><p>The experience of seeing pods automatically move from a failed node to healthy ones was really cool. This is what Kubernetes is designed for.</p><h2 id="things-i-wish-id-known-before-starting"><span class="me-2">Things I Wish I’d Known Before Starting</span><a href="#things-i-wish-id-known-before-starting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Looking back, here’s what would have saved me time:</p><p><strong>Get the networking sorted out first.</strong> Seriously. Make sure those static IPs are stable before you even think about installing k3s. I can’t stress this enough—if your master node’s IP changes later, you’re basically starting over.</p><p><strong>Skip WiFi, use ethernet.</strong> I tried having both enabled at first and it caused all sorts of weird routing problems. Just use ethernet and call it a day.</p><p><strong>Write everything down.</strong> IP addresses, hostnames, that join token—put it all in a text file. Future you will thank present you when something breaks at 11 PM and you can’t remember which node is which.</p><p><strong>Test as you go.</strong> Don’t configure all three Pis and then try to figure out what went wrong. Do one, make sure it works, then move to the next.</p><p><strong>Pis are slow, that’s okay.</strong> If a pod takes 45 seconds to start, that’s just how it is with Raspberry Pi. Don’t panic thinking something’s broken.</p><h2 id="what-you-learned"><span class="me-2">What You Learned</span><a href="#what-you-learned" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>✅ How to set up static networking on Raspberry Pi<br /> ✅ How to install and configure k3s on multiple nodes<br /> ✅ How to create a multi-node Kubernetes cluster on real hardware<br /> ✅ The importance of proper preparation (iptables, cgroups, networking)<br /> ✅ How to troubleshoot common cluster setup issues<br /> ✅ The difference between local development (k3d) and real clusters</p><h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Setting up k3s on Raspberry Pi was one of the most rewarding things I’ve done in my Kubernetes learning journey. Yeah, it took a few hours and I definitely had moments where I questioned my life choices (looking at you, networking issues), but seeing all three nodes report “Ready” made it all worth it.</p><p>The best part? Now I have a production-like environment sitting on my desk where I can break things without worrying about cloud bills. Everything I learned with k3d applies here, except now when I mess up, it’s on real hardware with actual network cables and blinking LEDs. There’s something satisfying about that.</p><p>If you’ve been learning Kubernetes with k3d or minikube, I’d say take the jump to real hardware when you feel ready. The lessons you get from dealing with actual networking problems and watching a node physically fail (or accidentally unplugging one) are different from simulations. Plus, having your own cluster just feels cool.</p><h2 id="whats-next"><span class="me-2">What’s Next?</span><a href="#whats-next" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In future posts, I’ll be documenting what I build on this cluster:</p><ul><li>Setting up Traefik Ingress with custom domains<li>Deploying a full Rails application with PostgreSQL<li>Configuring persistent storage with NFS<li>Implementing monitoring and logging<li>CI/CD pipelines targeting the cluster</ul><p>Stay tuned!</p><hr /><h2 id="series-navigation"><span class="me-2">Series Navigation</span><a href="#series-navigation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong>Part 1:</strong> <a href="/posts/kubernetes-learning-path-deploy-your-first-app/">Deploy Your First App</a><br /> <strong>Part 2:</strong> <a href="/posts/kubernetes-learning-path-configmaps-and-secrets/">ConfigMaps and Secrets</a><br /> <strong>Part 3:</strong> <a href="/posts/kubernetes-learning-path-namespaces/">Understanding Namespaces</a><br /> <strong>Part 4:</strong> <a href="/posts/kubernetes-learning-path-port-mapping/">Understanding Port Mapping in k3d</a><br /> <strong>Part 5:</strong> Setting Up k3s on Raspberry Pi ← You just finished this!<br /> <strong>Part 6:</strong> Persistent Storage (Coming soon)</p><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/kubernetes/">Kubernetes</a>, <a href="/categories/tutorial/">Tutorial</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >kubernetes</a> <a href="/tags/k3s/" class="post-tag no-text-decoration" >k3s</a> <a href="/tags/raspberry-pi/" class="post-tag no-text-decoration" >raspberry-pi</a> <a href="/tags/deployment/" class="post-tag no-text-decoration" >deployment</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> Thanks for reading! Feel free to share this post with others.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Kubernetes%20Learning%20Path:%20Setting%20Up%20k3s%20on%20Raspberry%20Pi%20-%20Shairyar%20Baig&url=https%3A%2F%2Fshairyar.github.io%2Fposts%2Fkubernetes-learning-path-k3s-on-raspberry-pi%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Kubernetes%20Learning%20Path:%20Setting%20Up%20k3s%20on%20Raspberry%20Pi%20-%20Shairyar%20Baig&u=https%3A%2F%2Fshairyar.github.io%2Fposts%2Fkubernetes-learning-path-k3s-on-raspberry-pi%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fshairyar.github.io%2Fposts%2Fkubernetes-learning-path-k3s-on-raspberry-pi%2F&text=Kubernetes%20Learning%20Path:%20Setting%20Up%20k3s%20on%20Raspberry%20Pi%20-%20Shairyar%20Baig" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/kubernetes-learning-path-persistent-storage/">Kubernetes Learning Path: Understanding Persistent Storage</a><li class="text-truncate lh-lg"> <a href="/posts/remote-access-to-k3s-homelab-with-tailscale/">Remote Access to Your k3s Homelab with Tailscale</a><li class="text-truncate lh-lg"> <a href="/posts/kubernetes-learning-path-rails-solidqueue-on-k3s/">Kubernetes Learning Path: Deploying Rails 8 with SolidQueue on Raspberry Pi k3s</a><li class="text-truncate lh-lg"> <a href="/posts/kubernetes-learning-path-ingress-controller/">Kubernetes Learning Path: Setting Up Ingress Controller for External Access</a><li class="text-truncate lh-lg"> <a href="/posts/kubernetes-learning-path-k3s-on-raspberry-pi/">Kubernetes Learning Path: Setting Up k3s on Raspberry Pi</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/k3d/">k3d</a> <a class="post-tag btn btn-outline-primary" href="/tags/k3s/">k3s</a> <a class="post-tag btn btn-outline-primary" href="/tags/deployment/">deployment</a> <a class="post-tag btn btn-outline-primary" href="/tags/raspberry-pi/">raspberry-pi</a> <a class="post-tag btn btn-outline-primary" href="/tags/configmap/">configmap</a> <a class="post-tag btn btn-outline-primary" href="/tags/networking/">networking</a> <a class="post-tag btn btn-outline-primary" href="/tags/postgresql/">postgresql</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby-on-rails/">ruby-on-rails</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/kubernetes-learning-path-rails-solidqueue-on-k3s/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1761901200" data-df="ll" > Oct 31, 2025 </time><h4 class="pt-0 my-2">Kubernetes Learning Path: Deploying Rails 8 with SolidQueue on Raspberry Pi k3s</h4><div class="text-muted"><p># Kubernetes Learning Path: Deploying Rails 8 with SolidQueue on Raspberry Pi k3s After setting up my 3-node Raspberry Pi k3s cluster in the [previous post](/posts/kubernetes-learning-path-k3s-on-...</p></div></div></a></article><article class="col"> <a href="/posts/remote-access-to-k3s-homelab-with-tailscale/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1762664400" data-df="ll" > Nov 9, 2025 </time><h4 class="pt-0 my-2">Remote Access to Your k3s Homelab with Tailscale</h4><div class="text-muted"><p># Remote Access to Your k3s Homelab with Tailscale While working on my k3s homelab cluster, I ran into an interesting challenge: how could I access my cluster when I wasn't home? I wanted to run `...</p></div></div></a></article><article class="col"> <a href="/posts/kubernetes-learning-path-ingress-controller/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1762401600" data-df="ll" > Nov 6, 2025 </time><h4 class="pt-0 my-2">Kubernetes Learning Path: Setting Up Ingress Controller for External Access</h4><div class="text-muted"><p># Kubernetes Learning Path: Setting Up Ingress Controller for External Access After deploying my Rails application with PostgreSQL and SolidQueue workers in the [previous post](/posts/kubernetes-l...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/kubernetes-learning-path-port-mapping/" class="btn btn-outline-primary" aria-label="Older" ><p>Kubernetes Learning Path: Understanding Port Mapping in k3d</p></a> <a href="/posts/kubernetes-learning-path-rails-solidqueue-on-k3s/" class="btn btn-outline-primary" aria-label="Newer" ><p>Kubernetes Learning Path: Deploying Rails 8 with SolidQueue on Raspberry Pi k3s</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/iamshairyar">Shairyar Baig</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.3.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/k3d/">k3d</a> <a class="post-tag btn btn-outline-primary" href="/tags/k3s/">k3s</a> <a class="post-tag btn btn-outline-primary" href="/tags/deployment/">deployment</a> <a class="post-tag btn btn-outline-primary" href="/tags/raspberry-pi/">raspberry-pi</a> <a class="post-tag btn btn-outline-primary" href="/tags/configmap/">configmap</a> <a class="post-tag btn btn-outline-primary" href="/tags/networking/">networking</a> <a class="post-tag btn btn-outline-primary" href="/tags/postgresql/">postgresql</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby-on-rails/">ruby-on-rails</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
